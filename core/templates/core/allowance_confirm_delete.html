{% extends 'core/dashboard_base.html' %}
{% load static %}

{% block dashboard_title %}Confirm Delete Allowance{% endblock %}

{% block page_title %}Confirm Delete Allowance{% endblock %}

{% block dashboard_content %}

{% include "core/dependency_warning.html" with related_count=related_count related_objects=related_allocations
go_back_url=request.META.HTTP_REFERER|default:"/core/allowance/" %}

{% if related_count == 0 %}
<p>Are you sure you want to delete <strong>"{{ allowance.name }}"</strong>?</p>
<form method="post" class="card">
    {% csrf_token %}

    <div style="margin-bottom: 1.5rem;">
        <label for="deleteConfirm" style="display: block; margin-bottom: 0.5rem; color: #4b5563;">Type
            <strong>delete</strong> to confirm:</label>
        <input type="text" id="deleteConfirm" autocomplete="off"
            style="width: 100%; padding: 0.75rem; border: 1px solid #d1d5db; border-radius: 0.5rem; max-width: 300px;">
    </div>

    <div class="form-actions">
        <button type="submit" id="deleteBtn" class="btn btn-danger" disabled
            style="opacity: 0.5; cursor: not-allowed;">Yes, Delete</button>
        <a href="{% url 'allowance_list' %}" class="btn btn-secondary">Cancel</a>
    </div>
</form>

<script>
    const input = document.getElementById('deleteConfirm');
    const btn = document.getElementById('deleteBtn');

    if (input && btn) {
        input.addEventListener('input', function () {
            if (this.value === 'delete') {
                btn.disabled = false;
                btn.style.opacity = '1';
                btn.style.cursor = 'pointer';
            } else {
                btn.disabled = true;
                btn.style.opacity = '0.5';
                btn.style.cursor = 'not-allowed';
            }
        });
    }
</script>
{% endif %}
{% endblock %}